<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regional Coverage Statistics - McKnight's American Football</title>
    <meta name="description" content="Game coverage statistics by region and state for McKnight's American Football Rankings database">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom Stylesheet -->
    <link href="/static-football-rankings/css/styles.css" rel="stylesheet">
    
    <!-- Plotly for interactive charts -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>
    
    <style>
        .region-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 5px solid;
        }
        
        .region-card.northeast { border-left-color: #4472C4; }
        .region-card.southeast { border-left-color: #70AD47; }
        .region-card.midwest { border-left-color: #FFC000; }
        .region-card.southwest { border-left-color: #C00000; }
        .region-card.west { border-left-color: #7030A0; }
        .region-card.canada { border-left-color: #E91E63; }
        
        .region-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .region-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            flex: 1;
            min-width: 120px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .chart-tabs {
            margin-top: 15px;
        }
        
        .chart-container {
            min-height: 600px;
            margin-top: 20px;
        }
        
        .comparison-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .section-title {
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .nav-pills .nav-link {
            color: #666;
            border-radius: 20px;
        }
        
        .nav-pills .nav-link.active {
            background-color: #667eea;
        }
    </style>
</head>
<body>
    <!-- Header Banner -->
    <div class="header-banner">
        <img src="/static-football-rankings/images/football-field-top.jpg" alt="Football Field Header" class="w-100" />
    </div>

    <!-- Breadcrumb navigation -->
    <div class="container mt-3">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/static-football-rankings/">Home</a></li>
                <li class="breadcrumb-item"><a href="/static-football-rankings/pages/public/database-statistics.html">Database Statistics</a></li>
                <li class="breadcrumb-item active" aria-current="page">Regional Coverage</li>
            </ol>
        </nav>
    </div>

    <div class="container mt-4 mb-5">
        <h1 class="text-center mb-4">Regional Coverage Statistics</h1>
        
        <div class="alert alert-info" role="alert">
            <strong>About This Page:</strong> These statistics show the geographical distribution of games in our database, 
            broken down by region and state. Each region's chart displays game coverage by season, allowing you to see 
            which states have the most comprehensive historical data.
        </div>

        <!-- Regional Comparison Section -->
        <div class="comparison-section">
            <h2 class="text-center mb-3">Compare All Regions</h2>
            <p class="text-center mb-4">See how game coverage varies across different regions of North America</p>
            <div id="regionalComparison" style="width: 100%; height: 600px;"></div>
        </div>

        <!-- Region Navigation -->
        <h2 class="section-title">Explore by Region</h2>
        
        <ul class="nav nav-pills justify-content-center mb-4" id="regionTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="northeast-tab" data-bs-toggle="pill" data-bs-target="#northeast" type="button">
                    Northeast
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="southeast-tab" data-bs-toggle="pill" data-bs-target="#southeast" type="button">
                    Southeast
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="midwest-tab" data-bs-toggle="pill" data-bs-target="#midwest" type="button">
                    Midwest
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="southwest-tab" data-bs-toggle="pill" data-bs-target="#southwest" type="button">
                    Southwest
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="west-tab" data-bs-toggle="pill" data-bs-target="#west" type="button">
                    West
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="canada-tab" data-bs-toggle="pill" data-bs-target="#canada" type="button">
                    Canada
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="regionTabContent">
            <!-- Northeast Region -->
            <div class="tab-pane fade show active" id="northeast" role="tabpanel">
                <div class="region-card northeast">
                    <div class="region-header">
                        <h3>Northeast Region</h3>
                    </div>
                    <div class="region-stats" id="northeast-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="northeast-games">-</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="northeast-seasons">-</div>
                            <div class="stat-label">Seasons</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="northeast-states">-</div>
                            <div class="stat-label">States</div>
                        </div>
                    </div>
                    
                    <div class="chart-tabs">
                        <ul class="nav nav-tabs" id="northeastChartTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-chart="games_by_state" data-region="northeast" href="#">By State</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="games_stacked" data-region="northeast" href="#">Stacked</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="total_by_state" data-region="northeast" href="#">Totals</a>
                            </li>
                        </ul>
                    </div>
                    <div class="chart-container" id="northeast-chart"></div>
                </div>
            </div>

            <!-- Southeast Region -->
            <div class="tab-pane fade" id="southeast" role="tabpanel">
                <div class="region-card southeast">
                    <div class="region-header">
                        <h3>Southeast Region</h3>
                    </div>
                    <div class="region-stats" id="southeast-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="southeast-games">-</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="southeast-seasons">-</div>
                            <div class="stat-label">Seasons</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="southeast-states">-</div>
                            <div class="stat-label">States</div>
                        </div>
                    </div>
                    
                    <div class="chart-tabs">
                        <ul class="nav nav-tabs" id="southeastChartTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-chart="games_by_state" data-region="southeast" href="#">By State</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="games_stacked" data-region="southeast" href="#">Stacked</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="total_by_state" data-region="southeast" href="#">Totals</a>
                            </li>
                        </ul>
                    </div>
                    <div class="chart-container" id="southeast-chart"></div>
                </div>
            </div>

            <!-- Midwest Region -->
            <div class="tab-pane fade" id="midwest" role="tabpanel">
                <div class="region-card midwest">
                    <div class="region-header">
                        <h3>Midwest Region</h3>
                    </div>
                    <div class="region-stats" id="midwest-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="midwest-games">-</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="midwest-seasons">-</div>
                            <div class="stat-label">Seasons</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="midwest-states">-</div>
                            <div class="stat-label">States</div>
                        </div>
                    </div>
                    
                    <div class="chart-tabs">
                        <ul class="nav nav-tabs" id="midwestChartTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-chart="games_by_state" data-region="midwest" href="#">By State</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="games_stacked" data-region="midwest" href="#">Stacked</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="total_by_state" data-region="midwest" href="#">Totals</a>
                            </li>
                        </ul>
                    </div>
                    <div class="chart-container" id="midwest-chart"></div>
                </div>
            </div>

            <!-- Southwest Region -->
            <div class="tab-pane fade" id="southwest" role="tabpanel">
                <div class="region-card southwest">
                    <div class="region-header">
                        <h3>Southwest Region</h3>
                    </div>
                    <div class="region-stats" id="southwest-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="southwest-games">-</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="southwest-seasons">-</div>
                            <div class="stat-label">Seasons</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="southwest-states">-</div>
                            <div class="stat-label">States</div>
                        </div>
                    </div>
                    
                    <div class="chart-tabs">
                        <ul class="nav nav-tabs" id="southwestChartTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-chart="games_by_state" data-region="southwest" href="#">By State</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="games_stacked" data-region="southwest" href="#">Stacked</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="total_by_state" data-region="southwest" href="#">Totals</a>
                            </li>
                        </ul>
                    </div>
                    <div class="chart-container" id="southwest-chart"></div>
                </div>
            </div>

            <!-- West Region -->
            <div class="tab-pane fade" id="west" role="tabpanel">
                <div class="region-card west">
                    <div class="region-header">
                        <h3>West Region</h3>
                    </div>
                    <div class="region-stats" id="west-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="west-games">-</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="west-seasons">-</div>
                            <div class="stat-label">Seasons</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="west-states">-</div>
                            <div class="stat-label">States</div>
                        </div>
                    </div>
                    
                    <div class="chart-tabs">
                        <ul class="nav nav-tabs" id="westChartTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-chart="games_by_state" data-region="west" href="#">By State</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="games_stacked" data-region="west" href="#">Stacked</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="total_by_state" data-region="west" href="#">Totals</a>
                            </li>
                        </ul>
                    </div>
                    <div class="chart-container" id="west-chart"></div>
                </div>
            </div>

            <!-- Canada Region -->
            <div class="tab-pane fade" id="canada" role="tabpanel">
                <div class="region-card canada">
                    <div class="region-header">
                        <h3>Canada Region</h3>
                    </div>
                    <div class="region-stats" id="canada-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="canada-games">-</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="canada-seasons">-</div>
                            <div class="stat-label">Seasons</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="canada-states">-</div>
                            <div class="stat-label">Provinces</div>
                        </div>
                    </div>
                    
                    <div class="chart-tabs">
                        <ul class="nav nav-tabs" id="canadaChartTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-chart="games_by_state" data-region="canada" href="#">By Province</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="games_stacked" data-region="canada" href="#">Stacked</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-chart="total_by_state" data-region="canada" href="#">Totals</a>
                            </li>
                        </ul>
                    </div>
                    <div class="chart-container" id="canada-chart"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-5 mb-3">
        <div class="container text-center">
            <p>&copy; 2025 McKnight's Football Rankings</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Chart Loading Script -->
    <script>
        const REGIONS = {
            'northeast': { name: 'Northeast', key: 'Northeast' },
            'southeast': { name: 'Southeast', key: 'Southeast' },
            'midwest': { name: 'Midwest', key: 'Midwest' },
            'southwest': { name: 'Southwest', key: 'Southwest' },
            'west': { name: 'West', key: 'West' },
            'canada': { name: 'Canada', key: 'Canada' }
        };

        let loadedCharts = {};

        // Load regional comparison chart
        fetch('/static-football-rankings/data/regional-statistics/regional_comparison.html')
            .then(response => response.text())
            .then(html => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const scriptTag = doc.querySelector('script[type="text/javascript"]');
                
                if (scriptTag) {
                    const plotlyCode = scriptTag.textContent;
                    const dataMatch = plotlyCode.match(/Plotly\.newPlot\([^,]+,\s*(\[[\s\S]*?\]),\s*(\{[\s\S]*?\})/);
                    
                    if (dataMatch) {
                        const data = eval(dataMatch[1]);
                        const layout = eval(dataMatch[2]);
                        layout.height = 600;
                        Plotly.newPlot('regionalComparison', data, layout, {displayModeBar: true, displaylogo: false});
                    }
                }
            })
            .catch(error => console.error('Error loading comparison chart:', error));

        // Load statistics for all regions
        fetch('/static-football-rankings/data/regional-statistics/all_regions_summary.json')
            .then(response => response.json())
            .then(data => {
                for (const [regionKey, stats] of Object.entries(data)) {
                    const regionLower = regionKey.toLowerCase();
                    document.getElementById(`${regionLower}-games`).textContent = stats.total_games.toLocaleString();
                    document.getElementById(`${regionLower}-seasons`).textContent = stats.total_seasons.toLocaleString();
                    document.getElementById(`${regionLower}-states`).textContent = 
                        `${stats.states_with_data}/${stats.states.length}`;
                }
            })
            .catch(error => console.error('Error loading statistics:', error));

        // Function to load a specific chart
        function loadChart(region, chartType) {
            const chartId = `${region}-chart`;
            const cacheKey = `${region}-${chartType}`;
            
            // Check if already loaded
            if (loadedCharts[cacheKey]) {
                return;
            }
            
            const url = `/static-football-rankings/data/regional-statistics/${region}/${chartType}.html`;
            
            fetch(url)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const scriptTag = doc.querySelector('script[type="text/javascript"]');
                    
                    if (scriptTag) {
                        const plotlyCode = scriptTag.textContent;
                        const dataMatch = plotlyCode.match(/Plotly\.newPlot\([^,]+,\s*(\[[\s\S]*?\]),\s*(\{[\s\S]*?\})/);
                        
                        if (dataMatch) {
                            const data = eval(dataMatch[1]);
                            const layout = eval(dataMatch[2]);
                            Plotly.newPlot(chartId, data, layout, {displayModeBar: true, displaylogo: false});
                            loadedCharts[cacheKey] = true;
                        }
                    }
                })
                .catch(error => {
                    console.error(`Error loading chart for ${region}:`, error);
                    document.getElementById(chartId).innerHTML = 
                        '<p class="text-danger text-center">Error loading chart</p>';
                });
        }

        // Load initial chart for Northeast
        loadChart('northeast', 'games_by_state');

        // Handle tab changes
        document.querySelectorAll('[data-bs-toggle="pill"]').forEach(tab => {
            tab.addEventListener('shown.bs.tab', event => {
                const region = event.target.getAttribute('data-bs-target').substring(1);
                loadChart(region, 'games_by_state');
            });
        });

        // Handle chart type changes
        document.querySelectorAll('[data-chart]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                const region = this.getAttribute('data-region');
                const chartType = this.getAttribute('data-chart');
                
                // Update active state
                this.closest('.nav-tabs').querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                // Load chart
                loadChart(region, chartType);
            });
        });
    </script>
</body>
</html>
